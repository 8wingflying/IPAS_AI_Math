# å‰ƒåº¦ä¸‹é™æ³•ï¼ˆGradient Descentï¼‰

## ðŸ“˜ ä¸€ã€æœ€åŸºæœ¬çš„ä¸€ç¶­å‰ƒåº¦ä¸‹é™æ³•ï¼šæœ€å°åŒ– f(x) = xÂ² + 3x + 2

### ç›®æ¨™

æˆ‘å€‘å¸Œæœ›æœ€å°åŒ–ï¼š 

$$ 
f(x)=x\^2+3x+2 
$$

å…¶å°Žæ•¸ç‚ºï¼š 

$$ 
f'(x)=2x+3 
$$

æ¢¯åº¦ä¸‹é™æ³• ==> x(æ–°) <-- x(èˆŠ) - (å­¸ç¿’çŽ‡)*(æ¢¯åº¦) 

------------------------------------------------------------------------

## âœ… Python ç¨‹å¼ç¢¼ï¼ˆä¸€ç¶­ç¯„ä¾‹ï¼‰

``` python
import numpy as np

# ç›®æ¨™å‡½æ•¸èˆ‡å°Žæ•¸
def f(x):
    return x**2 + 3*x + 2

def df(x):
    return 2*x + 3

# Gradient Descent
lr = 0.1          # å­¸ç¿’çŽ‡
x = 5.0           # åˆå§‹å€¼
epochs = 30       # è¿­ä»£æ¬¡æ•¸

history = []

for i in range(epochs):
    grad = df(x)
    x = x - lr * grad
    history.append((i, x, f(x)))
    print(f"iter {i:02d}: x={x:.5f}, f(x)={f(x):.5f}")

print("\næœ€ä½³è§£ç´„ç‚º x =", x)
```

------------------------------------------------------------------------

# â­ äºŒã€å¤šè®Šé‡ç·šæ€§å›žæ­¸ï¼šåˆ©ç”¨å‰ƒåº¦ä¸‹é™æ³•

æ¨¡åž‹ï¼š 

$$
y = wx + b 
$$

æå¤±å‡½æ•¸ï¼š 

$$
L = `\frac{1}{N}`{=tex}`\sum `{=tex}(wx+b-y)\^2 
$$

æ¢¯åº¦ï¼š 

$$
\frac{\partial L}{\partial w} =
`\frac{2}{N}`{=tex}`\sum x(wx+b-y) 
`\frac{\partial L}{\partial b}`{=tex} =
`\frac{2}{N}`{=tex}`\sum `{=tex}(wx+b-y) 
$$

------------------------------------------------------------------------

## âœ… Python ç¨‹å¼ç¢¼ï¼ˆç·šæ€§å›žæ­¸ï¼‰

``` python
import numpy as np

# å»ºç«‹å‡æ•¸æ“š
np.random.seed(0)
X = np.linspace(0, 10, 50)
y = 3 * X + 5 + np.random.randn(50)  # çœŸå¯¦ w=3, b=5

# åƒæ•¸åˆå§‹åŒ–
w = 0.0
b = 0.0
lr = 0.01
epochs = 2000

N = len(X)

for i in range(epochs):
    y_pred = w * X + b

    # è¨ˆç®—æ¢¯åº¦
    dw = (2/N) * np.sum(X * (y_pred - y))
    db = (2/N) * np.sum(y_pred - y)

    # æ›´æ–°
    w -= lr * dw
    b -= lr * db

    if i % 200 == 0:
        loss = np.mean((y_pred - y)**2)
        print(f"iter {i:04d}: loss={loss:.4f}, w={w:.4f}, b={b:.4f}")

print("\nå­¸åˆ°çš„åƒæ•¸ï¼š")
print("w =", w)
print("b =", b)
```

------------------------------------------------------------------------

# â­ ä¸‰ã€å¯è¦–åŒ–ï¼ˆé¸é…ï¼‰

``` python
import matplotlib.pyplot as plt

plt.scatter(X, y, label="data")
plt.plot(X, w * X + b, color='red', label="fit")
plt.legend()
plt.show()
```

------------------------------------------------------------------------

# ðŸ“Œ å¦‚éœ€é€²éšŽç‰ˆ

-   Momentum\
-   Adam\
-   å­¸ç¿’çŽ‡å‹•ç•«\
-   3D æå¤±é¢å¯è¦–åŒ–\
-   åŠ å…¥æ›´å¤šå¯¦ä½œç¯„ä¾‹

éƒ½å¯ä»¥å‘Šè¨´æˆ‘ï¼Œæˆ‘å¯ä»¥å¹«ä½ è£œä¸Šã€‚
